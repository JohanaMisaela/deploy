"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[566],{3566:(Ot,X,d)=>{d.r(X),d.d(X,{default:()=>ct});var r=d(8160),fe=d(1438),pe=d(8379),v=d(2093),ge=Object.defineProperty,Le=Object.defineProperties,Re=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,ee=(e,t,i)=>t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,U=(e,t)=>{for(var i in t||(t={}))Se.call(t,i)&&ee(e,i,t[i]);if(q)for(var i of q(t))ye.call(t,i)&&ee(e,i,t[i]);return e},V=(e,t)=>Le(e,Re(t)),Te=class{constructor(e,t){this.hlsStatsState={},this.hlsInstance=e,this.videoEl=t}getState(){return this.hlsStatsState}},Ae=class extends Te{constructor(){super(...arguments),this.timeUpdateHandler=()=>{let e=this.videoEl.buffered.length>0?this.videoEl.buffered.end(0)-this.videoEl.buffered.start(0):0,t=(this.hlsInstance.liveSyncPosition?this.hlsInstance.liveSyncPosition-this.videoEl.currentTime:0)*1e3,i=this.videoEl.getVideoPlaybackQuality().droppedVideoFrames;this.hlsStatsState=V(U({},this.hlsStatsState),{distanceFromLive:t>0?t:0,bufferedDuration:e,droppedFrames:i})},this.levelLoadedHandler=(e,{level:t})=>{let i=this.hlsInstance.levels[t],{bitrate:s,height:n,width:o}=i;this.hlsStatsState=V(U({},this.hlsStatsState),{bitrate:s,videoSize:{height:n,width:o}})},this.fragChangedHandler=(e,{frag:t})=>{let{stats:i,baseurl:s}=t,{bwEstimate:n}=i;this.hlsStatsState=V(U({},this.hlsStatsState),{bandwidthEstimate:n,url:s})}}startGatheringStats(){this.hlsInstance.on(v.Z.Events.FRAG_CHANGED,this.fragChangedHandler),this.hlsInstance.on(v.Z.Events.LEVEL_LOADED,this.levelLoadedHandler),this.videoEl.addEventListener("timeupdate",this.timeUpdateHandler)}finishGatheringStats(){this.videoEl.removeEventListener("timeupdate",this.timeUpdateHandler),this.hlsInstance.off(v.Z.Events.FRAG_CHANGED,this.fragChangedHandler),this.hlsInstance.off(v.Z.Events.LEVEL_LOADED,this.levelLoadedHandler)}},De=class{constructor(e,t){this.intervalFunctionId=-1,this.subscribe=(s,n=2e3)=>(this.adapter.startGatheringStats(),this.intervalFunctionId=setInterval(()=>{s(this.getState())},n),this.unsubscribe),this.unsubscribe=()=>{clearInterval(this.intervalFunctionId),this.adapter.finishGatheringStats()},this.getState=()=>this.adapter.getState();let i=new Ae(e,t);this.adapter=i}},Oe=d(9520),k=(e,t,i)=>new Promise((s,n)=>{var o=c=>{try{u(i.next(c))}catch(E){n(E)}},l=c=>{try{u(i.throw(c))}catch(E){n(E)}},u=c=>c.done?s(c.value):Promise.resolve(c.value).then(o,l);u((i=i.apply(e,t)).next())}),S=class extends Error{constructor(e,t,i,s=!1){super(t),this.name=e,this.message=t,this.description=i,this.isTerminal=s,Object.setPrototypeOf(this,S.prototype)}toAnalyticsProperties(){return{error_name:this.name,error_message:this.message,error_description:this.description,is_terminal:this.isTerminal}}addNativeError(e){this.nativeError=e}toString(){var e;return`{
      name: ${this.name};
      message: ${this.message};
      description: ${this.description};
      isTerminal: ${this.isTerminal};
      nativeError: ${(e=this.nativeError)==null?void 0:e.message};
    }`}},be=5,a;(function(e){e.TIMED_METADATA_LOADED="timed-metadata",e.SEEK_POS_BEHIND_LIVE_EDGE="seek-pos-behind-live-edge",e.CURRENT_TIME="current-time",e.AUTOPLAY_BLOCKED="autoplay-blocked",e.MANIFEST_LOADED="manifest-loaded",e.LAYER_UPDATED="layer-updated",e.ERROR="error",e.PLAYBACK_STATE="playback-state",e.STATS="stats"})(a||(a={}));var R;(function(e){e.MANIFEST_LOAD_ERROR="manifest-load-error",e.MANIFEST_PARSING_ERROR="manifest-parsing-error",e.LAYER_LOAD_ERROR="layer-load-error",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifest-incompatible-codecs-error",e.FRAG_DECRYPT_ERROR="frag-decrypt-error",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="buffer-incompatible-codecs-error",e.VIDEO_ELEMENT_NOT_FOUND="video-element-not-found",e.HLS_AUTOPLAY_FAILED="hls-autoplay-failed",e.HLS_URL_NOT_FOUND="hls-url-not-found",e.HLS_ERROR="hls-error"})(R||(R={}));var w;(function(e){e[e.playing=0]="playing",e[e.paused=1]="paused"})(w||(w={}));var y={HLSNetworkError:{manifestLoadError(e){return new S(R.MANIFEST_LOAD_ERROR,e.details,"Unable to load manifest file",e.fatal)},manifestParsingError(e){return new S(R.MANIFEST_PARSING_ERROR,e.details,"Unable to parse manifest file",e.fatal)},layerLoadError(e){return new S(R.LAYER_LOAD_ERROR,e.details,"Unable to load quality layers",e.fatal)}},HLSMediaError:{manifestIncompatibleCodecsError(e){return new S(R.MANIFEST_INCOMPATIBLE_CODECS_ERROR,e.details,"Incompatible manifest codecs",e.fatal)},fragDecryptError(e){return new S(R.FRAG_DECRYPT_ERROR,e.details,"Unable to decrypt fragment",e.fatal)},bufferIncompatibleCodecsError(e){return new S(R.BUFFER_INCOMPATIBLE_CODECS_ERROR,e.details,"Incompatible buffer codecs",e.fatal)},videoElementNotFound(){return new S(R.VIDEO_ELEMENT_NOT_FOUND,"Video element not found","Video element not found",!1)},autoplayFailed(){return new S(R.HLS_AUTOPLAY_FAILED,"Failed to autoplay","Failed to autoplay",!1)},hlsURLNotFound(e){return new S(R.HLS_URL_NOT_FOUND,e||"hls url not found",e||"hls url not found",!0)}},HLSError:(e,t=R.HLS_ERROR,i="Hls error")=>new S(t,e.details,i,e.fatal)},He=e=>{try{let t=window?.atob(e);return JSON.parse(t)}catch{return{payload:e}}},Ie=e=>e.map(t=>B(t)),B=e=>{var t;return{resolution:(t=e.attrs)==null?void 0:t.RESOLUTION,bitrate:e.bitrate,height:e.height,id:e.id,url:e.url[0],width:e.width}},Ce=class{constructor(e,t,i){this.videoEl=t,this.emitEvent=i,this.extractMetaTextTrack=()=>{let s=this.videoEl.textTracks.length||0;for(let n=0;n<s;n++){let o=this.videoEl.textTracks[n];if(o?.kind==="metadata")return o.mode="showing",o}return null},this.fireCues=(s,n)=>{var o;let l=(o=this.extractMetaTextTrack())==null?void 0:o.cues;if(!l)return;let u=l.length,c=0;for(;c<u;){let E=l[c];if(E.queued){c++;continue}let p=He(E.value.data),A=p.start_date,T=p.end_date,H=new Date(A).getTime()-s,J=new Date(T).getTime()-new Date(A).getTime();H<=n&&(setTimeout(()=>{this.emitEvent(a.TIMED_METADATA_LOADED,{id:E?.id,payload:p.payload,duration:J,startDate:new Date(A),endDate:new Date(T)})},H),E.queued=!0),c++}},this.handleTimeUpdateListener=()=>{var s;let n=this.extractMetaTextTrack();if(!n||!n.cues)return;let o=((s=this.videoEl)==null?void 0:s.getStartDate())||0,l=new Date(o).getTime()+(this.videoEl.currentTime||0)*1e3;this.fireCues(l,.25)},this.fragChangeHandler=(s,{frag:n})=>{if(!this.videoEl){let o=y.HLSMediaError.videoElementNotFound();this.emitEvent(a.ERROR,o)}try{if(this.videoEl.textTracks.length===0)return;let o=n.programDateTime||0,l=n.end-n.start;this.fireCues(o,l)}catch(o){console.error("FRAG_CHANGED event error",o)}},this.registerListner=()=>{v.Z.isSupported()?this.hls.on(v.Z.Events.FRAG_CHANGED,this.fragChangeHandler):this.videoEl.canPlayType("application/vnd.apple.mpegurl")&&this.videoEl.addEventListener("timeupdate",this.handleTimeUpdateListener)},this.unregisterListener=()=>{this.hls.off(v.Z.Events.FRAG_CHANGED,this.fragChangeHandler),this.videoEl.removeEventListener("timeupdate",this.handleTimeUpdateListener)},this.hls=e,this.registerListner()}},we=class{constructor(){this.eventEmitter=new Oe.EventEmitter2}on(e,t){this.eventEmitter.on(e,t)}off(e,t){this.eventEmitter.off(e,t)}emitEvent(e,t){return this.eventEmitter.emit(e,t,e)}removeAllListeners(e){this.eventEmitter.removeAllListeners(e)}},Pe=class{constructor(e,t){if(this._subscribeHlsStats=null,this.TAG="[HMSHLSPlayer]",this.subscribeStats=(i=2e3)=>{this._subscribeHlsStats=this._hlsStats.subscribe(s=>{this.emitEvent(a.STATS,s)},i)},this.unsubscribeStats=()=>{this._subscribeHlsStats&&this._subscribeHlsStats()},this.on=(i,s)=>{this._emitter.on(i,s)},this.off=(i,s)=>{this._emitter.off(i,s)},this.emitEvent=(i,s)=>{var n,o;if(i===a.ERROR){let l=s;l?.isTerminal&&((o=(n=window?.__hms)==null?void 0:n.sdk)==null||o.sendHLSAnalytics(l))}return this._emitter.emitEvent(i,s)},this.removeAllListeners=i=>{this._emitter.removeAllListeners(i)},this.play=()=>k(this,null,function*(){yield this.playVideo()}),this.pause=()=>{this.pauseVideo()},this.seekTo=i=>{this._videoEl.currentTime=i},this.playVideo=()=>k(this,null,function*(){try{this._videoEl.paused&&(yield this._videoEl.play())}catch(i){console.debug(this.TAG,"Play failed with error",i.message),i.name==="NotAllowedError"&&this.emitEvent(a.AUTOPLAY_BLOCKED,y.HLSMediaError.autoplayFailed())}}),this.pauseVideo=()=>{this._videoEl.paused||this._videoEl.pause()},this.playEventHandler=()=>{this.emitEvent(a.PLAYBACK_STATE,{state:w.playing})},this.pauseEventHandler=()=>{this.emitEvent(a.PLAYBACK_STATE,{state:w.paused})},this.volumeEventHandler=()=>{this._volume=this._videoEl.volume},this.handleHLSException=(i,s)=>{var n,o;console.error(this.TAG,`error type ${s.type} with details ${s.details} is fatal ${s.fatal}`);let l={details:((n=s.error)==null?void 0:n.message)||((o=s.err)==null?void 0:o.message)||"",fatal:s.fatal};switch(s.details){case v.Z.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR:{let u=y.HLSMediaError.manifestIncompatibleCodecsError(l);this.emitEvent(a.ERROR,u);break}case v.Z.ErrorDetails.FRAG_DECRYPT_ERROR:{let u=y.HLSMediaError.fragDecryptError(l);this.emitEvent(a.ERROR,u);break}case v.Z.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR:{let u=y.HLSMediaError.bufferIncompatibleCodecsError(l);this.emitEvent(a.ERROR,u);break}case v.Z.ErrorDetails.MANIFEST_LOAD_ERROR:{let u=y.HLSNetworkError.manifestLoadError(l);this.emitEvent(a.ERROR,u);break}case v.Z.ErrorDetails.MANIFEST_PARSING_ERROR:{let u=y.HLSNetworkError.manifestParsingError(l);this.emitEvent(a.ERROR,u);break}case v.Z.ErrorDetails.LEVEL_LOAD_ERROR:{let u=y.HLSNetworkError.layerLoadError(l);this.emitEvent(a.ERROR,u);break}default:{let u=y.HLSError(l,s.type,s.details);this.emitEvent(a.ERROR,u);break}}},this.manifestLoadedHandler=(i,{levels:s})=>{let n=Ie(this.removeAudioLevels(s));this.emitEvent(a.MANIFEST_LOADED,{layers:n})},this.levelUpdatedHandler=(i,{level:s})=>{let n=B(this._hls.levels[s]);this.emitEvent(a.LAYER_UPDATED,{layer:n})},this.handleTimeUpdateListener=i=>{this.emitEvent(a.CURRENT_TIME,this._videoEl.currentTime);let s=this._hls.liveSyncPosition?this._hls.liveSyncPosition-this._videoEl.currentTime<=be:!1;this._isLive!==s&&(this._isLive=s,this.emitEvent(a.SEEK_POS_BEHIND_LIVE_EDGE,{isLive:this._isLive}))},this._hls=new v.Z(this.getPlayerConfig()),this._emitter=new we,this._hlsUrl=e,this._videoEl=t||this.createVideoElement(),e){if(!e.endsWith("m3u8"))throw y.HLSMediaError.hlsURLNotFound("Invalid URL, pass m3u8 url")}else throw y.HLSMediaError.hlsURLNotFound();this._hls.loadSource(e),this._hls.attachMedia(this._videoEl),this._isLive=!0,this._volume=this._videoEl.volume*100,this._hlsStats=new De(this._hls,this._videoEl),this.listenHLSEvent(),this._metaData=new Ce(this._hls,this._videoEl,this.emitEvent),this.seekToLivePosition()}createVideoElement(){if(this._videoEl)return this._videoEl;let e=document.createElement("video");return e.playsInline=!0,e.controls=!1,e.autoplay=!0,e}getVideoElement(){return this._videoEl}reset(){this._hls&&this._hls.media&&(this._hls.detachMedia(),this.unsubscribeStats()),this._metaData&&this._metaData.unregisterListener(),v.Z.isSupported()&&(this._hls.off(v.Z.Events.MANIFEST_LOADED,this.manifestLoadedHandler),this._hls.off(v.Z.Events.LEVEL_UPDATED,this.levelUpdatedHandler),this._hls.off(v.Z.Events.ERROR,this.handleHLSException)),this._videoEl&&(this._videoEl.removeEventListener("play",this.playEventHandler),this._videoEl.removeEventListener("pause",this.pauseEventHandler),this._videoEl.removeEventListener("timeupdate",this.handleTimeUpdateListener),this._videoEl.removeEventListener("volumechange",this.volumeEventHandler)),this.removeAllListeners()}get volume(){return this._volume}setVolume(e){this._videoEl.volume=e/100,this._volume=e}getLayer(){var e,t;if(this._hls&&this._hls.currentLevel!==-1){let i=(t=this._hls)==null?void 0:t.levels.at((e=this._hls)==null?void 0:e.currentLevel);return i?B(i):null}return null}setLayer(e){if(this._hls){let t=this._hls.levels.findIndex(i=>{var s;return((s=i?.attrs)==null?void 0:s.RESOLUTION)===e?.resolution});this._hls.currentLevel=t}}seekToLivePosition(){return k(this,null,function*(){let e=0;if(this._videoEl.buffered.length>0&&(e=this._videoEl.buffered.end(this._videoEl.buffered.length-1)),this._videoEl.currentTime=this._hls.liveSyncPosition||e,this._videoEl.paused)try{yield this.playVideo()}catch(t){console.error(this.TAG,"Attempt to jump to live position Failed.",t)}})}listenHLSEvent(){v.Z.isSupported()?(this._hls.on(v.Z.Events.MANIFEST_LOADED,this.manifestLoadedHandler),this._hls.on(v.Z.Events.LEVEL_UPDATED,this.levelUpdatedHandler),this._hls.on(v.Z.Events.ERROR,this.handleHLSException),this.subscribeStats()):this._videoEl.canPlayType("application/vnd.apple.mpegurl")&&(this._videoEl.src=this._hlsUrl),this._videoEl.addEventListener("timeupdate",this.handleTimeUpdateListener),this._videoEl.addEventListener("play",this.playEventHandler),this._videoEl.addEventListener("pause",this.pauseEventHandler),this._videoEl.addEventListener("volumechange",this.volumeEventHandler)}getPlayerConfig(){return{enableWorker:!0,maxBufferLength:20,backBufferLength:10,abrBandWidthUpFactor:1}}removeAudioLevels(e){return e.filter(({videoCodec:t,width:i,height:s})=>!!t||!!(i&&s))}},$e=d(8523),xe=d.n($e),Z=d(9067),te=d(8081),Me=d(6532),Fe=d(7854),Ne=d(9314),f=d(8485),x=d(5861),M=d(455),I=d(6939),D=d(8721),_e=e=>r.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.707 6.707a1 1 0 0 0-1.414-1.414L12 10.586 6.707 5.293a1 1 0 0 0-1.414 1.414L10.586 12l-5.293 5.293a1 1 0 1 0 1.414 1.414L12 13.414l5.293 5.293a1 1 0 0 0 1.414-1.414L13.414 12l5.293-5.293Z",fill:"currentColor"}));function Ue({hlsStatsState:e,onClose:t}){var i,s,n;return r.createElement(f.k,{css:{position:"absolute",width:"$80",marginLeft:"$8",padding:"$8 $8 $10",zIndex:10,backgroundColor:"rgba(55,59,66, 0.84)",borderRadius:"$1"},direction:"column"},r.createElement(x.h,{css:{position:"absolute",top:"$2",right:"$2"},onClick:t},r.createElement(_e,null)),r.createElement(b,{label:"URL"},r.createElement(f.k,{align:"center"},r.createElement("a",{style:{cursor:"pointer",textDecoration:"underline"},href:e?.url,target:"_blank",rel:"noreferrer"},"Stream url"))),r.createElement(b,{label:"Video size"},` ${(i=e?.videoSize)==null?void 0:i.width}x${(s=e?.videoSize)==null?void 0:s.height}`),r.createElement(b,{label:"Buffer duration"},(n=e?.bufferedDuration)==null?void 0:n.toFixed(2)," "),r.createElement(b,{label:"Connection speed"},`${(e?.bandwidthEstimate/(1e3*1e3)).toFixed(2)} Mbps`),r.createElement(b,{label:"Bitrate"},`${(e?.bitrate/(1e3*1e3)).toFixed(2)} Mbps`),r.createElement(b,{label:"distance from live"},Ve(e.distanceFromLive/1e3)),r.createElement(b,{label:"Dropped frames"},`${e?.droppedFrames}`))}function Ve(e){let t=Math.floor(e);const i=Math.floor(t/3600);t=t-i*3600;const s=Math.floor(t/60),n=Math.floor(t-s*60),o=`${s<10?"0"+s:s}`,l=`${n<10?"0"+n:n}`;let u=`${o}:${l}`;return i&&(u=`${`${i<10?"0"+i:i}`}:${o}:${l}`),u}const b=(0,r.memo)(({label:e,children:t})=>r.createElement(f.k,{gap:4,justify:"center",css:{width:"100%"}},r.createElement(D.x,{css:{width:"50%","@md":{fontSize:"$md"},"@sm":{fontSize:"$sm"}}},e),r.createElement(D.x,{css:{"@md":{fontSize:"$md"},"@sm":{fontSize:"$sm"},width:"50%",overflowWrap:"break-word"}},t)));var G=d(9290);const ke=(0,G.zo)(f.k,{justifyContent:"center",alignItems:"center",width:"100%",gap:"$2"}),Be=(0,G.zo)(f.k,{justifyContent:"flex-start",alignItems:"center",width:"100%",gap:"$2"}),Ze=(0,G.zo)(f.k,{justifyContent:"flex-end",alignItems:"center",width:"100%",gap:"$2"});var ie=d(8160);const Ge=(0,r.forwardRef)(({children:e},t)=>ie.createElement(f.k,{"data-testid":"hms-video",css:{size:"100%"},direction:"column"},ie.createElement("video",{style:{flex:"1 1 0",margin:"0 auto",minHeight:"0"},ref:t,playsInline:!0}),e));var je=d(4053),Ye=d(8338),F=d(8160);const ze=({onClick:e,isPaused:t})=>F.createElement(M.u,{title:`${t?"Play":"Pause"}`,side:"top"},F.createElement(x.h,{onClick:e,"data-testid":"play_pause_btn"},t?F.createElement(je.Z,{width:32,height:32}):F.createElement(Ye.Z,{width:32,height:32})));function j(e,t){return e/t*100}function Ke(e){let t=Math.floor(e);const i=Math.floor(t/3600);t=t-i*3600;const s=Math.floor(t/60),n=Math.floor(t-s*60),o=`${s<10?"0"+s:s}`,l=`${n<10?"0"+n:n}`;let u=`${o}:${l}`;return i&&(u=`${`${i<10?"0"+i:i}`}:${o}:${l}`),u}var N=d(8160);const Qe=({onValueChange:e,hlsPlayer:t})=>{const[i,s]=(0,r.useState)(0),[n,o]=(0,r.useState)(0),l=(0,r.useRef)();(0,r.useEffect)(()=>{const c=t.getVideoElement(),E=()=>{var p;const A=Math.floor(j(c.currentTime,c.duration));let T=0;c.buffered.length>0&&(T=Math.floor(j((p=c.buffered)==null?void 0:p.end(0),c.duration))),s(isNaN(A)?0:A),o(isNaN(T)?0:T)};return c&&c.addEventListener("timeupdate",E),function(){c&&c.removeEventListener("timeupdate",E)}},[]);const u=c=>{const E=c.clientX-l.current.offsetLeft,p=l.current.offsetWidth,A=Math.floor(j(E,p)),T=t.getVideoElement(),H=A*T.duration/100;e&&e(H)};return t.getVideoElement()?N.createElement(f.k,{ref:l,css:{paddingLeft:"$8",paddingRight:"$8",cursor:"pointer"},onClick:u},N.createElement(I.x,{id:"video-actual",css:{display:"inline",width:`${i}%`,background:"$primaryDefault",height:"0.3rem"}}),N.createElement(I.x,{id:"video-buffer",css:{width:`${n-i}%`,background:"$primaryDark",height:"0.3rem"}}),N.createElement(I.x,{id:"video-rest",css:{width:`${100-n}%`,background:"$grayLight",height:"0.3rem"}})):null};var We=d(8160);const Je=({hlsPlayer:e})=>{const[t,i]=(0,r.useState)("");return(0,r.useEffect)(()=>{const s=n=>i(Ke(n));return e&&e.on(a.CURRENT_TIME,s),function(){e&&e.off(a.CURRENT_TIME,s)}},[e]),e?We.createElement(D.x,{css:{minWidth:"$16"},variant:{"@sm":"xs"}},`${t}`):null};var Xe=d(7506),qe=d(8651),Y=d(8160);const O={Root:Ge,PlayButton:ze,Progress:Qe,Duration:Je,Volume:({hlsPlayer:e})=>{var t;const[i,s]=(0,r.useState)((t=e?.volume)!=null?t:100);return Y.createElement(f.k,{align:"center",css:{color:"$white"}},Y.createElement(Xe.Z,{style:{cursor:"pointer"},onClick:()=>{s(0),e&&e.setVolume(0)}}),Y.createElement(qe.i,{css:{mx:"$4",w:"$20",cursor:"pointer","@sm":{w:"$14"},"@xs":{w:"$14"}},min:0,max:100,step:1,value:[i],onValueChange:n=>{e.setVolume(n),s(n)},thumbStyles:{w:"$6",h:"$6"}}))},Controls:{Root:ke,Left:Be,Right:Ze}};var z=d(8160);const et=({isFullScreen:e,icon:t,onToggle:i})=>z.createElement(M.u,{title:`${e?"Exit":"Go"} fullscreen`,side:"top"},z.createElement(x.h,{variant:"standard",css:{margin:"0px"},onClick:i,key:"fullscreen_btn","data-testid":"fullscreen_btn"},z.createElement(f.k,null,t)));var tt=d(622),it=d(7688),K=d(4778);function st({open:e,unblockAutoPlay:t}){return r.createElement(tt.V.Root,{open:e,onOpenChange:i=>{i||t()}},r.createElement(K.cZ,{title:"Attention",closeable:!1},r.createElement(K.DP,null,r.createElement(D.x,{variant:"md"},'The browser wants us to get a confirmation for playing the HLS Stream. Please click "play stream" to proceed.')),r.createElement(K.DP,{justify:"end"},r.createElement(it.z,{variant:"primary",onClick:()=>{t()}},"Play stream"))))}var rt=d(3510),se=e=>r.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 3a9 9 0 0 0-9 9 9 9 0 0 0 9 9 9 9 0 0 0 9-9 9 9 0 0 0-9-9Zm-7.364 9a7.363 7.363 0 1 1 14.727 0 7.363 7.363 0 0 1-14.727 0Zm10.397-1.058a.818.818 0 1 0-1.157-1.157l-2.694 2.694-1.058-1.058a.818.818 0 0 0-1.157 1.158l1.636 1.636c.32.32.838.32 1.157 0l3.273-3.273Z",fill:"currentColor"})),P=d(9024),m=d(8160);function nt({layers:e,onQualityChange:t,selection:i,isAuto:s}){const[n,o]=(0,r.useState)(!1);return m.createElement(P.L.Root,{open:n,onOpenChange:l=>o(l)},m.createElement(P.L.Trigger,{asChild:!0,"data-testid":"quality_selector"},m.createElement(f.k,{css:{color:"$textPrimary",r:"$1",cursor:"pointer",p:"$2"}},m.createElement(M.u,{title:"Select Quality",side:"top"},m.createElement(f.k,{align:"center"},m.createElement(I.x,{css:{w:"$9",h:"$9",display:"inline-flex",alignItems:"center"}},m.createElement(rt.Z,null)),m.createElement(D.x,{variant:{"@md":"sm","@sm":"xs","@xs":"tiny"},css:{display:"flex",alignItems:"center",ml:"$2"}},s&&m.createElement(m.Fragment,null,"Auto",m.createElement(I.x,{css:{mx:"$2",w:"$2",h:"$2",background:"$textPrimary",r:"$1"}})),i&&Math.min(i.width,i.height),"p"))))),e.length>0&&m.createElement(P.L.Content,{sideOffset:5,align:"end",css:{height:"auto",maxHeight:"$96",w:"$64"}},m.createElement(P.L.Item,{onClick:l=>t({height:"auto"}),key:"auto"},m.createElement(D.x,{css:{flex:"1 1 0"}},"Automatic"),s&&m.createElement(se,null)),e.map(l=>m.createElement(P.L.Item,{onClick:()=>t(l),key:l.width},m.createElement(D.x,{css:{flex:"1 1 0"}},lt(l)),!s&&l.width===i?.width&&l.height===i?.height&&m.createElement(se,null)))))}const lt=e=>`${Math.min(e.height,e.width)}p (${(Number(e.bitrate/1e3)/1e3).toFixed(2)} Mbps)`;var at=d(7097),Q=d(5581),re=Object.getOwnPropertySymbols,ot=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable,ht=(e,t)=>{var i={};for(var s in e)ot.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&re)for(var s of re(e))t.indexOf(s)<0&&dt.call(e,s)&&(i[s]=e[s]);return i},W=(e,t,i)=>new Promise((s,n)=>{var o=c=>{try{u(i.next(c))}catch(E){n(E)}},l=c=>{try{u(i.throw(c))}catch(E){n(E)}},u=c=>c.done?s(c.value):Promise.resolve(c.value).then(o,l);u((i=i.apply(e,t)).next())});let h;const ct=()=>{var e;const t=(0,r.useRef)(null),i=(0,r.useRef)(null),s=(0,Z._U)(te.Yt),n=(0,Z._U)((0,te.EP)(Q._8.hlsStats)),o=(0,Z.cw)(),{themeType:l}=(0,Ne.Fg)();let[u,c]=(0,r.useState)(null);const E=(e=s.variants[0])==null?void 0:e.url,[p,A]=(0,r.useState)([]),[T,H]=(0,r.useState)(!0),[J,ut]=(0,r.useState)(!0),[Et,vt]=(0,r.useState)(null),[mt,ne]=(0,r.useState)(!1),[le,ft]=(0,r.useState)(!1),pt=xe().isEnabled,[gt,ae]=(0,fe.Z)(!1),oe=(0,pe.Z)(i,gt,{onClose:()=>ae(!1)});(0,r.useEffect)(()=>{let g=t.current;const _=({layers:L})=>{A(L)},de=({layer:L})=>{vt(L)},he=L=>{var me=L,{payload:yt}=me,Tt=ht(me,["payload"]);const At=$=>{try{return JSON.parse($)}catch{return $}},Dt=Tt.duration,C=At(yt);switch(C.type){case Q.nf:window.showFlyingEmoji(C?.emojiId,C?.senderId);break;default:{const $={title:`Payload from timed Metadata ${C}`,duration:Dt||3e3};console.debug("Added toast ",JSON.stringify($)),at.y.addToast($);break}}},ce=L=>{console.error("[HLSView] error in hls",`${L}`)},ue=({isLive:L})=>{H(L)},Ee=L=>ft(L.state===w.paused),ve=L=>ne(!!L);if(g&&E)return h=new Pe(E,g),h.on(a.SEEK_POS_BEHIND_LIVE_EDGE,ue),h.on(a.TIMED_METADATA_LOADED,he),h.on(a.ERROR,ce),h.on(a.PLAYBACK_STATE,Ee),h.on(a.AUTOPLAY_BLOCKED,ve),h.on(a.MANIFEST_LOADED,_),h.on(a.LAYER_UPDATED,de),()=>{h.off(a.SEEK_POS_BEHIND_LIVE_EDGE,ue),h.off(a.ERROR,ce),h.off(a.TIMED_METADATA_LOADED,he),h.off(a.PLAYBACK_STATE,Ee),h.off(a.AUTOPLAY_BLOCKED,ve),h.off(a.MANIFEST_LOADED,_),h.off(a.LAYER_UPDATED,de),h.reset(),h=null}},[E]),(0,r.useEffect)(()=>{const g=_=>c(_);return n?h?.on(a.STATS,g):h?.off(a.STATS,g),()=>{h?.off(a.STATS,g)}},[n]);const Lt=()=>W(void 0,null,function*(){try{yield h.play(),ne(!1)}catch(g){console.error("Tried to unblock Autoplay failed with",g.message)}}),Rt=(0,r.useCallback)(g=>{h&&(ut(g.height.toString().toLowerCase()==="auto"),h.setLayer(g))},[p]),St=()=>{o.setAppData(Q._8.hlsStats,!n)};return r.createElement(f.k,{key:"hls-viewer",id:`hls-viewer-${l}`,ref:i,css:{size:"100%"}},u?.url&&n?r.createElement(Ue,{hlsStatsState:u,onClose:St}):null,E&&s.running?r.createElement(f.k,{id:"hls-player-container",align:"center",justify:"center",css:{width:"100%",margin:"0 auto",height:"100%"}},r.createElement(st,{open:mt,unblockAutoPlay:Lt}),r.createElement(O.Root,{ref:t},h&&r.createElement(O.Progress,{onValueChange:g=>{h.seekTo(g)},hlsPlayer:h}),r.createElement(O.Controls.Root,{css:{p:"$4 $8"}},r.createElement(O.Controls.Left,null,r.createElement(O.PlayButton,{onClick:()=>W(void 0,null,function*(){le?yield h?.play():h?.pause()}),isPaused:le}),r.createElement(O.Duration,{hlsPlayer:h}),r.createElement(O.Volume,{hlsPlayer:h})),r.createElement(O.Controls.Right,null,p.length>0?r.createElement(r.Fragment,null,r.createElement(x.h,{variant:"standard",css:{px:"$2"},onClick:()=>W(void 0,null,function*(){yield h.seekToLivePosition(),H(!0)}),key:"jump-to-live_btn","data-testid":"jump-to-live_btn"},r.createElement(M.u,{title:"Go to Live",side:"top"},r.createElement(f.k,{justify:"center",gap:2,align:"center"},r.createElement(I.x,{css:{height:"$4",width:"$4",background:T?"$error":"$white",r:"$1"}}),r.createElement(D.x,{variant:{"@sm":"xs"}},T?"LIVE":"GO LIVE")))),r.createElement(nt,{layers:p,selection:Et,onQualityChange:Rt,isAuto:J})):null,pt?r.createElement(et,{isFullScreen:oe,onToggle:ae,icon:oe?r.createElement(Me.Z,null):r.createElement(Fe.Z,null)}):null)))):r.createElement(f.k,{align:"center",justify:"center",css:{size:"100%",px:"$10"}},r.createElement(D.x,{variant:"md",css:{textAlign:"center"}},"Waiting for the stream to start...")))}}}]);

//# sourceMappingURL=566.54f124ae.js.map